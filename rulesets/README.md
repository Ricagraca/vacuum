
## OWASP Rules

The table provides an overview of OWASP (Open Web Application Security Project) rules, which are security guidelines and best practices for building secure web applications. Each rule focuses on a specific aspect of API security and suggests measures to mitigate potential vulnerabilities.

| Rule                                | Description                                                                                                                                                                                                                                                                                                                                      | Severity | Implemented |
|-------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|-------------|
| OwaspAPIRuleNoNumericIDs            | OWASP API1:2019 - Use random IDs that cannot be guessed. UUIDs are preferred.                                                                                                                                                                                                                                                                                       | Error    |      X      |
| OWASPRuleSecuritySchemeUseHTTPBasic | Basic authentication credentials transported over network are more susceptible to interception than other forms of authentication, and as they are not encrypted it means passwords and tokens are more easily leaked                                                                                                                                                                                                                               | Error    |      X      |
| OWASPRuleNoAPIKeysInURL             | API Keys are (usually opaque) strings that are passed in headers, cookies, or query parameters to access APIs. Those keys can be eavesdropped, especially when they are stored in cookies or passed as URL parameters.                                                                                                                  | Error    |      X      |
| OWASPRuleSecurityCredentialsDetected| URL parameters MUST NOT contain credentials such as API key, password, or secret. See RAC_GEN_004                                                                                                                                | Error    |     X       |
| OWASPRuleAuthInsecureSchemes        | There are many HTTP authorization schemes, but some of them are now considered insecure, such as negotiating authentication using specifications like NTLM or OAuth v1                                                                                                               | Error    |       X      |
| OWASPRuleJWTBestPractices           | Security schemes using JWTs must explicitly declare support for RFC8725 in the description                                                                                                                                                     There                                                                                                | Error    |      X       |
| OWASPRuleProtectionGlobalUnsafe     |  Your API should be protected by a `security` rule either at global or operation level. All operations should be protected especially when they\nnot safe (methods that do not alter the state of the server) \nHTTP methods like `POST`, `PUT`, `PATCH` and `DELETE`.\nThis is done with one or more non-empty `security` rules.\n\nSecurity rules are defined in the `securityScheme` section | Warn     |   TODO      |
| OWASPRuleProtectionGlobalUnsafeStrict| Check if the operation is protected at operation level.\nOtherwise, check the global `#/security` property | Warn     |   TODO      |
| OWASPRuleProtectionGlobalSafe       |  Check if the operation is protected at operation level.\nOtherwise, check the global `#/security` property | Warn     |   TODO      |
| OWASPRuleDefineErrorValidation      | Carefully define schemas for all the API responses, including either 400, 422, or 4XX responses which describe errors caused by invalid requests                                                                                                                                                            | Warn     | uses a function |
| OWASPRuleDefineErrorResponses401    | OWASP API Security recommends defining schemas for all responses, even errors. The 401 describes what happens when a request is unauthorized, so it's important to define this not just for documentation, but to empower contract testing to make sure the proper JSON structure is being returned instead of leaking implementation details in backtraces                | Warn     |      X      |
| OWASPRuleDefineErrorResponses500    | OWASP API Security recommends defining schemas for all responses, even errors. The 500 describes what happens when a request fails with an internal server error, so it's important to define this not just for documentation, but to empower contract testing to make sure the proper JSON structure is being returned instead of leaking implementation details in backtraces                | Warn     |      X      |
| OWASPRuleRateLimit                  | Define proper rate limiting to avoid attackers overloading the API. There are many ways to implement rate-limiting, but most of them involve using HTTP headers, and there are two popular ways to do that:\n\nIETF Draft HTTP RateLimit Headers:. https://datatracker.ietf.org/doc/draft-ietf-httpapi-ratelimit-headers/\n\nCustomer headers like X-Rate-Limit-Limit (Twitter: https://developer.twitter.com/en/docs/twitter-api/rate-limits) or X-RateLimit-Limit (GitHub: https://docs.github.com/en/rest/overview/resources-in-the-rest-api)                                                                                                                                                                                                                        | Warn     | uses a function |
| OWASPRuleRateLimitRetryAfter        | Define proper rate limiting to avoid attackers overloading the API. Part of that involves setting a Retry-After header so well meaning consumers are not polling and potentially exacerbating problems                                                                                                                                             | Error    |      X      |
| OWASPRuleDefineErrorResponses429    | OWASP API Security recommends defining schemas for all responses, even errors. A HTTP 429 response signals the API client is making too many requests, and will supply information about when to retry so that the client can back off calmly without everything breaking. Defining this response is important not just for documentation, but to empower contract testing to make sure the proper JSON structure is being returned instead of leaking implementation details in backtraces. It also ensures your API/framework/gateway actually has rate limiting set up                | Warn     |      X      |
| OWASPRuleArrayLimit | Array size should be limited to mitigate resource exhaustion attacks. This can be done using `maxItems`. You should ensure that the subschema in `items` is constrained too | Error | X (Outputs more errors than it should) |
| OWASPRuleStringLimit | String size should be limited to mitigate resource exhaustion attacks. This can be done using `maxLength`, `enum` or `const` | Error | X (Outputs more errors than it should) |
| OWASPRuleStringRestricted | To avoid unexpected values being sent or leaked, ensure that strings have either a `format`, RegEx `pattern`, `enum`, or `const` | Error | X  (Outputs more errors than it should) |
| OWASPRuleIntegerLimit | Integers should be limited to mitigate resource exhaustion attacks. This can be done using `minimum` and `maximum`, which can with e.g.: avoiding negative numbers when positive are expected, or reducing unreasonable iterations like doing something 1000 times when 10 is expected | Error | TODO |
| OWASPRuleIntegerLimitLegacy | Integers should be limited to mitigate resource exhaustion attacks. This can be done using `minimum` and `maximum`, which can with e.g.: avoiding negative numbers when positive are expected, or reducing unreasonable iterations like doing something 1000 times when 10 is expected | Error | TODO |
| OWASPRuleIntegerFormat | Integers should be limited to mitigate resource exhaustion attacks. Specifying whether int32 or int64 is expected via `format` | Error | TODO |
| OWASPRuleNoAdditionalProperties     | By default, JSON Schema allows additional properties, which can potentially lead to mass assignment issues, where unspecified fields are passed to the API without validation. Disable them with `additionalProperties: false` or add `maxProperties`                                                                                             | Warn     |      X      |
| OWASPRuleConstrainedAdditionalProperties     | By default JSON Schema allows additional properties, which can potentially lead to mass assignment issues, where unspecified fields are passed to the API without validation. Disable them with `additionalProperties: false` or add `maxProperties`                                                                                             | Warn     |      X      |
| OWASPRuleSecurityHostsHTTPOAS2     | All server interactions MUST use the https protocol, so the only OpenAPI scheme being used should be `https`.\n\nLearn more about the importance of TLS (over SSL) here: https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html                                                                                             | Error     |      PROGRESS     |
| OWASPRuleSecurityHostsHTTPOAS3     | All server interactions MUST use the https protocol, meaning server URLs should begin `https://`.\n\nLearn more about the importance of TLS (over SSL) here: https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html                                                                                             | Error     |      PROGRESS     |
